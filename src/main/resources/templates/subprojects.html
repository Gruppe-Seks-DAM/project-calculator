<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Subprojects</title>
  <style>
    * { box-sizing: border-box; }
    body { margin: 0; font-family: Arial, sans-serif; background-color: #fff; display:flex; justify-content:center; }
    .page-frame { margin:20px; border:2px solid #0c3c57; background:#fff; width:90vw; max-width:1200px; min-height:80vh; padding:40px 60px; position:relative; }
    .header { text-align:center; margin-bottom:24px; }
    .header-title { font-size:22px; font-weight:bold; letter-spacing:1px; }
    .header-subtitle { margin-top:8px; font-size:13px; color:#444; }
    .actions { display:flex; justify-content:space-between; align-items:center; margin-bottom:18px; }
    .create-link { text-decoration:none; background:#0c3c57; color:#fff; padding:8px 14px; border-radius:6px; }
    .back-link { color:#0c3c57; text-decoration:none; font-size:13px; }
    .subprojects-list { margin-top:20px; }
    .subproject-label { font-size:13px; letter-spacing:3px; margin-bottom:8px; }
    .subproject-row { display:flex; align-items:center; justify-content:space-between; margin-bottom:22px; }
    .subproject-box { flex:1; border:1px solid #000; padding:16px 20px; margin-right:20px; }
    .subproject-name { font-size:15px; letter-spacing:1px; text-transform:uppercase; margin-bottom:6px; }
    .subproject-meta { font-size:13px; color:#444; margin-top:4px; }
    .circle-button { width:44px; height:44px; border-radius:50%; background:#000; display:flex; align-items:center; justify-content:center; text-decoration:none; color:#fff; }
    .delete-form { margin-top:6px; }
    .delete-button { background:none; border:none; color:#b00020; font-size:11px; text-transform:uppercase; letter-spacing:1px; cursor:pointer; padding:0; }
    .empty-state { margin-top:60px; text-align:center; font-style:italic; color:#777; }
  </style>
</head>
<body>
<div class="page-frame">
  <div class="header">
    <div class="header-title">SUBPROJECTS</div>
    <div class="header-subtitle">Subprojects for project <span th:text="${projectId}">#</span></div>
  </div>

  <div class="actions">
    <a class="back-link" th:href="@{/projects}">&larr; Back to projects</a>
    <a class="create-link" th:href="@{|/projects/${projectId}/subprojects/create|}">Create subproject</a>
  </div>

  <div class="subprojects-list" th:if="${!#lists.isEmpty(subprojects)}">
    <div th:each="sp, stat : ${subprojects}">
      <div class="subproject-label">
        SUBPROJECT <span th:text="${stat.index + 1}">1</span>
      </div>

      <div class="subproject-row">
        <div class="subproject-box">
          <div class="subproject-name" th:text="${#strings.isEmpty(sp.name) ? 'Untitled Subproject' : sp.name}">Untitled Subproject</div>

          <div class="subproject-meta">
            Deadline:
            <span th:text="${sp.deadline != null ? sp.deadline : '—'}">—</span>
          </div>

          <div class="subproject-meta">
            Total estimated hours:
            <span th:text="${sp.totalEstimatedHours != null ? sp.totalEstimatedHours : '—'}">—</span>
          </div>
        </div>

        <div style="display:flex; flex-direction:column; gap:8px; align-items:flex-end;">
          <a class="circle-button" th:href="@{|/projects/${projectId}/subprojects/${sp.id}/tasks|}" title="Open tasks">≡</a>

          <a class="circle-button" th:href="@{|/projects/${projectId}/subprojects/${sp.id}/edit|}" title="Edit">✏</a>

          <form class="delete-form" th:action="@{|/projects/${projectId}/subprojects/${sp.id}/delete|}" method="post" th:object="${sp}">
            <button type="submit" class="delete-button">Delete</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="empty-state" th:if="${#lists.isEmpty(subprojects)}">
    No subprojects yet. Create the first subproject for this project.
  </div>
</div>
</body>
</html>